<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
	<!--<link rel="stylesheet" type="text/css" href="css/materialize.css">-->
	<!--<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="css/style.css">-->
	<!--<link rel="stylesheet" type="text/css" href="css/jogo.css">-->

	<script type="text/javascript" src="js/jcrop/jquery.color.js"></script>
	<script type="text/javascript" src="js/jcrop/jquery.Jcrop.js"></script>

	<link rel="stylesheet" type="text/css" href="css/jcrop/jquery.Jcrop.css">


	<style type="text/css">
		#preview{
			height: 200px;			
			width: 200px;
			overflow: hidden;
		}
	</style>
	<script type="text/javascript">
		$(function(){

			var orig_w = 400;
			var orig_h = 500;



			var targ_w = 200;
			var targ_h = 200;

			var radio = 1;

			const coordenadas = {
				x:0,
				y:0,
				w:0,
				h:0
			}

			var canvas = document.getElementById('canvas'),
			context = canvas.getContext('2d');

			/*$('#imagem').Jcrop({
			  setSelect: [ 0,0,200,200 ],
			  aspectRatio: 1,
			  onChange: update
			});*/

			function update(c){
				coordenadas.x = c.x;
				coordenadas.y = c.y;
				coordenadas.w = c.w;
				coordenadas.h = c.h;
				console.log(c);
			}

			$(document).on("click", "button", gerarImagem);

			$('#imagem').Jcrop({
			    onChange: updatePreview,
			    onSelect: updatePreview,
			    allowSelect: true,
			    allowMove: true,
			    allowResize: true,
			    aspectRatio: 0
			});

			function gerarImagem(){

				var canvas = document.createElement('canvas');

				canvas.id = "canvas";
				canvas.width = 200;
				canvas.height = 200;
				canvas.style.zIndex = 8;
				canvas.style.border = "1px solid";


				var body = document.getElementsByTagName("body")[0];
				body.appendChild(canvas);

				const context = canvas.getContext("2d");
				const imagem = new Image();
				imagem.src = "covers/image_cover.jpg";
				imagem.onload = function(){
					context.drawImage(imagem,coordenadas.x,coordenadas.y, coordenadas.w, coordenadas.h,0,0,200,200);

				}
				
			}

			function updatePreview(c) {
			    if (parseInt(c.w) > 0) {
			        // Show image preview
			        var imageObj = $("#imagem")[0];
			        var canvas = $("#canvas")[0];
			        var context = canvas.getContext("2d");

			        if (imageObj != null && c.x != 0 && c.y != 0 && c.w != 0 && c.h != 0) {
			            context.drawImage(imageObj, c.x, c.y, c.w, c.h, 0, 0, canvas.width, canvas.height);
			        }
			    }
			}
		});
	</script>

</head>
<body>


	<div class="container">
		<div class="row">
			<div class="col s12">
				<h4 class="center">Jogo da Mem√≥ria</h4>
				<div class="card">
					<div class="card-content">
						<table>
							<tr>
								<td><div><img src="covers/image_cover.jpg" width="200px" height="200px"></div></td>
								<td><div><video src="trem.mp4" width="100px" height="200px" controls></video></div></td>
								<td><div><img src="covers/video_cover.png" width="100px" height="200px"></div></td>
								<td><div><img src="covers/image_cover.jpg" width="100px" height="200px"></div></td>
							</tr>
							<tr>
								<td><div><img src="covers/video_cover.png" width="100px" height="200px"></div></td>
								<td><div><img src="covers/image_cover.jpg" width="100px" height="200px"></div></td>
								<td><div><img src="covers/image_cover.jpg" width="100px" height="200px"></div></td>
								<td><div><img src="covers/video_cover.png" width="100px" height="200px"></div></td>
							</tr>
						</table>
					</div>
				</div>
			</div>
		</div>	
	</div>

	<table>
		<tr>
			<td>
				<img src="covers/image_cover.jpg" width="400px" height="500px" id="imagem">
			</td>
			<td>Preview:<div id="preview"><img src="covers/image_cover.jpg"></div></td>
		</tr>
	</table>
	<button>Gerar imagem</button>
	</div>
	<canvas width="200" height="200" id="canvas"></canvas>
	<br>
	<br>
	<br>
	<br>
	<br>
</body>
</html>